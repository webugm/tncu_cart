<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
             
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>  
    <!-- <script src="https://code.jquery.com/jquery-migrate-1.2.1.js"></script>         -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <title>Google無紙化工作術</title>
  </head>
  <body>
    <script>
      $(function(){
            var cell = [];
            var row = "";
            var col = "";

            $.getJSON('https://spreadsheets.google.com/feeds/cells/11bu19qy39prfZDEum8NpeNt76-1yQu3ZUioKcVodvUQ/1/public/values?alt=json', function (data){
                //console.log(data.feed.entry);
                // console.log(data.feed.entry[0].gs$cell.row);
                // console.log(data.feed.entry[0].gs$cell.col);
                // console.log(data.feed.entry[0].gs$cell.$t);
                // //console.log(data.feed.entry.length);
                for (var i=0; i < data.feed.entry.length; i++){
                  row = data.feed.entry[i].gs$cell.row;
                  col = data.feed.entry[i].gs$cell.col;
                  if(!Array.isArray(cell[row])){
                    cell[row]= new Array();
                  }
                  if(!Array.isArray(cell[row][col])){
                    cell[row][col]= new Array();
                  }                    
                  cell[row][col] = data.feed.entry[i].gs$cell.$t;
                  
                  //$('#producttable').append("<tr><td>" + row + "</td><td>" + title[i] + "</td></tr>");
                }
                cell.forEach(function(e) {
                  $('#producttable').append("<tr><td>" + e[1] + "</td><td>" + e[2] + "</td></tr>");
                  console.log(e);
                });
                //console.log(cell);
            });
        });
    </script>
    <div class="container my-5">
      <h1 class="text-center">使用Google Spreadsheet做為網頁資料庫</h1>
      <table class="table table-dark table-striped table-bordered table-hover table-sm">
        <tbody id="producttable">
        </tbody>
      </table>
      <hr>
      <a href="https://docs.google.com/spreadsheets/d/11bu19qy39prfZDEum8NpeNt76-1yQu3ZUioKcVodvUQ/edit?usp=sharing" target="_blank" class="btn btn-primary">編輯「spreadsheets」</a>
      <a href="http://ccs.tncomu.tw/modules/ccs_course/index.php?op=view_course&course_sn=7198" target="_blank" class="btn btn-success">我想知道如何作，報名去</a>
      <a href="#" target="_blank" class="btn btn-danger">真正運用時，可以將權限設定，那訪客只能在網頁瀏覽</a>
      <hr>
      <p>
        上課時間： 每週四 晚上07:00～09:50 第一次上課日期：09 月 20 日<br>
        開課地點： 成功國中（台南市北區和緯路1 段2 號）<br>
        報名地點： 台南社大-後甲國中、大成國中辦公室
      </p>
      <p>
        到底這樣的流程可以運用在什麼地方，那就看學員的需求了！
      </p>
      


    </div>


  </body>
</html>